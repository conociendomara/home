<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Conociendo Mara</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous"/>
    
    <style>
        :root {
            --bg: #0f1724;
            --card: #0b1220;
            --accent1: #ff6b6b;
            --accent2: #6bffd9;
            --glass: rgba(255,255,255,0.04);
            --glass-2: rgba(255,255,255,0.02);
            --muted: rgba(255,255,255,0.6);
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: var(--bg);
            color: #e6f0ff;
            min-height: 100vh;
        }
        
        /* Loading indicator */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: #e6f0ff;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--accent1);
            border-top: 3px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Header */
        header {
            padding: 24px;
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: space-between;
            background: var(--card);
            border-bottom: 1px solid var(--glass-2);
        }
        
        .logo {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .logo .mark {
            width: 46px;
            height: 46px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #041017;
        }
        
        h1 {
            font-size: 18px;
            margin: 0;
        }
        
        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .btn {
            background: var(--glass);
            border: 1px solid rgba(255,255,255,0.04);
            padding: 10px 14px;
            border-radius: 10px;
            cursor: pointer;
            color: inherit;
            transition: all 0.2s ease;
        }
        
        .btn:hover {
            background: var(--accent1);
            color: #041017;
        }
        
        /* Main container */
        .container {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 18px;
            padding: 18px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Left panel */
        .panel {
            background: var(--card);
            border-radius: 12px;
            padding: 14px;
            border: 1px solid var(--glass-2);
            box-shadow: 0 6px 24px rgba(2,6,23,0.6);
        }
        
        .search {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .search input {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: 0;
            background: #051023;
            color: inherit;
        }
        
        .filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }
        
        .chip {
            padding: 8px 10px;
            border-radius: 999px;
            background: #061226;
            color: var(--muted);
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.03);
            transition: all 0.2s ease;
            font-size: 12px;
        }
        
        .chip.active {
            background: var(--accent1);
            color: #041017;
            border-color: var(--accent1);
        }
        
        .dest-list {
            display: grid;
            gap: 10px;
            max-height: 60vh;
            overflow: auto;
            padding-right: 6px;
        }
        
        .dest {
            display: flex;
            gap: 10px;
            padding: 10px;
            border-radius: 10px;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
            border: 1px solid rgba(255,255,255,0.02);
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .dest:hover {
            background: rgba(255,255,255,0.05);
        }
        
        .dest img {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            object-fit: cover;
            transition: all 0.3s ease;
        }
        
        .dest img:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }
        
        .dest .meta {
            flex: 1;
        }
        
        .dest h4 {
            margin: 0;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .dest h4:hover {
            color: var(--accent1);
            text-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
        }
        
        .dest p {
            margin: 4px 0 0;
            font-size: 12px;
            color: var(--muted);
        }
        
        .go-btn {
            padding: 6px 8px;
            border-radius: 8px;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
            border: 0;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            font-weight: bold;
        }
        
        .go-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(90deg, #45a049, #4CAF50);
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }
        
        /* Right panel */
        .stage {
            display: grid;
            grid-template-rows: 60px 1fr 200px;
            gap: 12px;
        }
        
        .video-wrap {
            background: var(--card);
            border-radius: 12px;
            padding: 14px;
            border: 1px solid var(--glass-2);
            box-shadow: 0 6px 24px rgba(2,6,23,0.6);
        }
        
        .hero {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            border-radius: 12px;
            background: linear-gradient(90deg, rgba(107,255,217,0.06), rgba(255,107,107,0.04));
            border: 1px solid rgba(255,255,255,0.02);
        }
        
        .map-wrap {
            height: 420px;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--glass-2);
        }
        
        #map {
            width: 100%;
            height: 100%;
        }
        
        .itinerary {
            background: linear-gradient(180deg, #041226, transparent);
            padding: 12px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.02);
            min-height: 140px;
        }
        
        .itinerary h3 {
            margin: 0 0 8px 0;
        }
        
        .it-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .it-item {
            padding: 10px;
            background: #06132a;
            border-radius: 8px;
            border: 1px dashed rgba(255,255,255,0.03);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
        }
        
        .it-item:hover {
            background: #071a3a;
        }
        
        .grab {
            cursor: grab;
        }
        
        .grab:active {
            cursor: grabbing;
        }
        
        /* Footer */
        footer {
            padding: 18px;
            text-align: center;
            color: var(--muted);
            background: var(--card);
            border-top: 1px solid var(--glass-2);
        }
        
        /* Responsive */
        @media (max-width: 920px) {
            .container {
                grid-template-columns: 1fr;
                padding: 12px;
                gap: 12px;
            }
            .video-wrap video {
                height: 250px;
            }
            .stage {
                grid-template-rows: auto 1fr auto;
                gap: 12px;
            }
            .hero {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            .hero h3 {
                font-size: 16px;
            }
            .hero div {
                font-size: 12px;
            }
        }
        
        @media (max-width: 768px) {
            header {
                padding: 16px;
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }
            .logo {
                justify-content: center;
            }
            .controls {
                justify-content: center;
                flex-wrap: wrap;
            }
            .btn {
                padding: 8px 12px;
                font-size: 12px;
            }
            .container {
                padding: 8px;
                gap: 8px;
            }
            .panel {
                padding: 12px;
            }
            .search {
                flex-direction: column;
                gap: 8px;
            }
            .search input {
                font-size: 16px; /* Evita zoom en iOS */
            }
            .filters {
                justify-content: center;
            }
            .chip {
                font-size: 11px;
                padding: 6px 8px;
            }
            .dest {
                flex-direction: column;
                text-align: center;
                gap: 8px;
            }
            .dest img {
                width: 100%;
                height: 150px;
                object-fit: cover;
            }
            .dest .meta h4 {
                font-size: 16px;
                margin-bottom: 8px;
            }
            .dest .meta p {
                font-size: 13px;
                margin-bottom: 12px;
            }
            .go-btn {
                width: 100%;
                padding: 10px;
                font-size: 14px;
            }
            .video-wrap video {
                height: 200px;
            }
            .info-panel h3 {
                font-size: 16px;
            }
            .info-panel h4 {
                font-size: 14px;
            }
            .info-panel p {
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .logo h1 {
                font-size: 16px;
            }
            .logo div {
                font-size: 11px;
            }
            .dest-list {
                max-height: 50vh;
            }
            .dest {
                padding: 12px;
            }
            .dest img {
                height: 120px;
            }
            .video-wrap video {
                height: 180px;
            }
            .stage {
                grid-template-rows: auto 1fr auto;
            }
        }
        
        /* Modal responsive */
        @media (max-width: 768px) {
            .modal-content {
                padding: 15px !important;
                margin: 5px !important;
                max-height: 98vh !important;
            }
            .modal-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            .modal-map {
                height: 200px !important;
            }
            .modal-close {
                width: 40px !important;
                height: 40px !important;
                font-size: 20px !important;
            }
        }
        
        /* Mejoras t√°ctiles para m√≥viles */
        @media (max-width: 768px) {
            .dest img, .dest h4 {
                -webkit-tap-highlight-color: rgba(255, 107, 107, 0.3);
                cursor: pointer;
            }
            .btn, .chip, .go-btn {
                -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
                min-height: 44px; /* Tama√±o m√≠nimo recomendado para toques */
            }
            .dest {
                -webkit-tap-highlight-color: transparent;
            }
        }
        
        /* Error states */
        .error-message {
            padding: 20px;
            text-align: center;
            color: var(--accent1);
            background: rgba(255, 107, 107, 0.1);
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .empty-state {
            padding: 20px;
            text-align: center;
            color: var(--muted);
        }
    </style>
</head>
<body>
    <!-- Loading indicator -->
    <div id="loading">
        <div style="text-align: center">
            <div class="spinner"></div>
            <p>Cargando aplicaci√≥n de turismo...</p>
        </div>
    </div>
    
    <header>
        <div class="logo">
            <div class="mark">TR</div>
            <div>
                <h1>Conociendo Mara</h1>
                <div style="font-size:12px;color:var(--muted)">Explora los lugares, conoce sus origenes y localizacion</div>
            </div>
        </div>
        <div class="controls">
            <button class="btn" id="btn-history">Historia de Mara</button>
            <button class="btn" id="btn-theme">Modo Claro</button>
            <button class="btn" id="btn-download">Exportar itinerario</button>
        </div>
    </header>
    
    <main class="container">
        <aside class="panel">
            <div class="search">
                <input id="search" placeholder="Buscar destino (playa, monta√±a, ciudad...)" />
                <button class="btn" id="btn-random">Sugerir</button>
            </div>
            <div class="filters" id="filters">
                <div class="chip active" data-type="todo">Todo</div>
                <div class="chip" data-type="playa">Playa</div>
                <div class="chip" data-type="montana">Monta√±a</div>
                <div class="chip" data-type="ciudad">Ciudad</div>
                <div class="chip" data-type="cultura">Cultura</div>
            </div>
            <div class="dest-list panel" id="destinations">
                <div class="empty-state">Cargando destinos...</div>
            </div>
            <div style="font-size: 11px; color: var(--muted); text-align: center; margin-top: 8px; padding: 8px; background: rgba(255,255,255,0.02); border-radius: 6px;">
                üí° Haz clic en la imagen o nombre para ver m√°s informaci√≥n
            </div>
        </aside>

        <section class="stage">
            <div class="hero panel">
                <div>
                    <strong id="selected-count">0</strong> destinos seleccionados
                    <div style="font-size:13px;color:var(--muted)">Arrastra las tarjetas al itinerario a la derecha</div>
                </div>
                <div class="carousel">
                    <div class="card-preview" id="preview">Vista previa del destino</div>
                </div>
            </div>

            <div class="video-wrap panel">
                <h3 style="margin-top:0;color:var(--accent1)">üé¨ Conoce el Municipio Mara</h3>
                <div style="position:relative;width:100%;height:300px;border-radius:12px;overflow:hidden;background:#000">
                    <video 
                        id="mara-video"
                        controls
                        preload="metadata"
                        style="width:100%;height:100%;object-fit:cover;border:none"
                        poster="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjMDAwIi8+CjxjaXJjbGUgY3g9IjIwMCIgY3k9IjE1MCIgcj0iNDAiIGZpbGw9InJnYmEoMjU1LDI1NSwyNTUsMC4yKSIvPgo8cGF0aCBkPSJNMTg1IDEzNUwyMTUgMTUwTDE4NSAxNjVWMTM1WiIgZmlsbD0iI2ZmZmZmZiIvPgo8dGV4dCB4PSIyMDAiIHk9IjIwMCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmaWxsPSIjZmZmZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5NdW5pY2lwaW8gTWFyYTwvdGV4dD4KPC9zdmc+">
                        <source src="videos/mara-promocional.mp4" type="video/mp4">
                        <source src="videos/mara-promocional.webm" type="video/webm">
                        <source src="videos/mara-promocional.ogg" type="video/ogg">
                        <p style="color:white;text-align:center;padding:50px">
                            Tu navegador no soporta la reproducci√≥n de video.<br>
                            <a href="videos/mara-promocional.mp4" style="color:#6bffd9">Descargar video</a>
                        </p>
                    </video>
                </div>
                <div style="margin-top:15px;padding:15px;background:rgba(255,255,255,0.02);border-radius:8px">
                    <h4 style="margin:0 0 10px 0;color:var(--accent2)">üåü Municipio Mara</h4>
                    <p style="margin:0;font-size:13px;line-height:1.4;color:var(--muted)">
                        Tierra noble de serran√≠as, planicies y orillas del Lago de Maracaibo. 
                        Hogar de la fusi√≥n de razas ind√≠genas, europeas y africanas que conforman 
                        la identidad marense. Descubre nuestra rica cultura, tradiciones ancestrales 
                        y la belleza natural que Dios nos ha brindado.
                    </p>
                </div>
            </div>

            <div class="itinerary panel" id="itinerary">
                <h3>Itinerario <small style="color:var(--muted)"> (arrastrar para reordenar)</small></h3>
                <div class="it-list" id="it-list">
                    <div class="empty-state">Arrastra destinos aqu√≠ para crear tu itinerario</div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal de Historia -->
    <div id="history-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:10000;overflow:auto">
        <div style="background:var(--card);margin:20px auto;max-width:800px;border-radius:15px;padding:30px;border:1px solid var(--glass-2)">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <h2 style="margin:0;color:var(--accent1)">üèõÔ∏è Historia y Or√≠genes del Municipio Mara</h2>
                <button id="close-history" style="background:var(--accent1);color:#041017;border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;font-size:16px">√ó</button>
            </div>
            
            <div style="line-height:1.6;color:#e6f0ff">
                <h3 style="color:var(--accent2)">üéµ El Himno de Mara</h3>
                <p>El himno del Municipio Mara es un canto que entona las bellezas naturales tales como las serran√≠as, las planicies y las riberas de los r√≠os y del Lago de Maracaibo, as√≠ como al pueblo mar√©nse, fusi√≥n de razas: ind√≠genas, europeos y africanos.</p>
                
                <div style="background:rgba(255,255,255,0.05);padding:15px;border-radius:10px;margin:15px 0">
                    <h4 style="color:var(--accent1);margin-top:0">Coro:</h4>
                    <p><em>"Tierra noble, conjunto de encantos<br>
                    serran√≠a, planicies y orillas<br>
                    que hace un lazo de la maravilla<br>
                    que Dios, con amor te ha brindado.<br><br>
                    
                    Raza y estirpe tu marensidad<br>
                    que conjugan nuestro mestizaje<br>
                    al trabajo de campo y celaje<br>
                    en tu lago de zulianidad"</em></p>
                </div>

                <h3 style="color:var(--accent2)">üè¥ Bandera Municipal</h3>
                <p>La bandera del municipio Mara est√° formada por tres franjas de igual tama√±o:</p>
                <ul>
                    <li><strong style="color:#4CAF50">Franja Verde:</strong> Representa la riqueza agr√≠cola y pecuaria, adem√°s la esperanza que tienen todos los marenses.</li>
                    <li><strong style="color:#fff">Franja Blanca:</strong> Representa la pureza, el gentilicio y hospitalidad de la gente de Mara. Incluye una estrella negra de cinco puntas que representa las cinco grandes riquezas: petr√≥leo, carb√≥n, agricultura, ganader√≠a y pesca.</li>
                    <li><strong style="color:#2196F3">Franja Azul:</strong> Representa al r√≠o Lim√≥n y al Lago de Maracaibo, fuentes principales de subsistencia econ√≥mica y alimentaria.</li>
                </ul>

                <h3 style="color:var(--accent2)">üõ°Ô∏è Escudo Municipal</h3>
                <p><strong>Autor:</strong> Alfredo Ballesteros</p>
                <p>El escudo representa:</p>
                <ul>
                    <li><strong>Parte superior izquierda:</strong> La riqueza del carb√≥n, fuente de recursos econ√≥micos</li>
                    <li><strong>Parte superior derecha:</strong> La actividad ganadera</li>
                    <li><strong>Parte inferior:</strong> Las aguas del Lago de Maracaibo y el r√≠o Lim√≥n con el puente "Guajira Venezolana"</li>
                    <li><strong>Marco:</strong> Cocoteros (izquierda) y uvas (derecha), cultivos representativos del municipio</li>
                </ul>

                <h3 style="color:var(--accent2)">üë• Pueblos Ind√≠genas</h3>
                <p>El municipio Mara es heredero de grandes pueblos ind√≠genas:</p>
                <ul>
                    <li><strong>Zapara, Toas y Caribes:</strong> Pueblos originarios de la regi√≥n</li>
                    <li><strong>Way√∫u y Paraujanos:</strong> Que viven en las orillas del lago como fieles compa√±eros</li>
                </ul>
                <p>Estos pueblos enfrentaron con honor al caudillo voraz, ofreciendo a su tierra el sudor como soldados valientes y leales.</p>

                <h3 style="color:var(--accent2)">üèõÔ∏è Origen del Nombre</h3>
                <p>Fue idea de <strong>Ignacio Chac√≠n</strong> y el esfuerzo de <strong>Sixto De Vicente</strong> concretar esa idea valiente: llamar al municipio "Mara" con bombo y clar√≠n, en honor al heroico Cacique Mara.</p>

                <h3 style="color:var(--accent2)">‚õ™ Fe y Tradici√≥n</h3>
                <p>Esta tierra bendita ora a la dulce Madre del Carmelo, que desde Espa√±a se vino a este suelo a sembrar el futuro que hoy aflora.</p>

                <div style="background:linear-gradient(90deg,var(--accent1),var(--accent2));padding:15px;border-radius:10px;margin-top:20px;text-align:center">
                    <p style="margin:0;color:#041017;font-weight:bold">
                        "¬°Vuelve mar√©nse a tu identidad!<br>
                        que la historia por siempre nos llama<br>
                        a la luz de tu viva llama,<br>
                        a trabajo de fe y hermandad."
                    </p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        Todos los derechos reservados. UPTMA - Mojan
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>
    
    <script>
        // Datos de destinos con informaci√≥n contextual y promocional
        const destinations = [
            {
                id: 1,
                name: 'San Rafael de El Moj√°n (Plaza & Iglesia)',
                type: 'cultura',
                lat: 10.96205,
                lon: -71.73034,
                desc: 'Centro hist√≥rico y cultural: Plaza Bol√≠var, iglesia San Rafael Arc√°ngel y vida local.',
                context: 'El coraz√≥n espiritual y cultural del Municipio Mara. Aqu√≠ convergen la fe cat√≥lica tra√≠da desde Espa√±a y las tradiciones ind√≠genas locales. La Plaza Bol√≠var es testigo de la fusi√≥n de razas que caracteriza a los marenses: ind√≠genas, europeos y africanos. La iglesia San Rafael Arc√°ngel representa la esperanza y la uni√≥n de los habitantes, siendo un s√≠mbolo de la nobleza y hospitalidad que caracteriza a esta tierra.',
                virtues: ['Centro espiritual √∫nico', 'Arquitectura colonial preservada', 'Cultura mestiza aut√©ntica', 'Tradiciones vivas'],
                img: 'https://images.unsplash.com/photo-1545558014-8692077e9b5c?auto=format&fit=crop&w=400&q=80'
            },
            {
                id: 2,
                name: 'Puente Guajira Venezolana (R√≠o Lim√≥n)',
                type: 'cultura',
                lat: 10.9988889,
                lon: -71.8175,
                desc: 'Puente ic√≥nico que une Mara y P√°ez; importante v√≠a sobre el r√≠o Lim√≥n.',
                context: 'S√≠mbolo de conexi√≥n y progreso del Municipio Mara. Este puente representa la uni√≥n entre pueblos hermanos y es testimonio del desarrollo de la regi√≥n. Construido sobre el r√≠o Lim√≥n, conecta no solo territorios sino tambi√©n culturas y tradiciones. Es un monumento al ingenio humano y a la determinaci√≥n de los marenses por construir un futuro mejor.',
                virtues: ['Arquitectura moderna impresionante', 'Conexi√≥n estrat√©gica regional', 'Vista panor√°mica del r√≠o', 'S√≠mbolo de progreso'],
                img: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?auto=format&fit=crop&w=400&q=80'
            },
            {
                id: 3,
                name: 'Laguna de Sinamaica',
                type: 'playa',
                lat: 11.08397,
                lon: -71.85565,
                desc: 'Laguna y manglares en la costa noroccidental del Zulia; naturaleza y pesca artesanal.',
                context: 'Tesoro natural del Municipio Mara donde la naturaleza se manifiesta en su m√°xima expresi√≥n. Esta laguna es el hogar de una rica biodiversidad y el sustento de comunidades pesqueras ancestrales. Los manglares forman un ecosistema √∫nico que protege la costa y proporciona recursos naturales. Es un lugar donde la tradici√≥n pesquera se mantiene viva, conectando a los visitantes con las ra√≠ces culturales de los pueblos ind√≠genas ribere√±os.',
                virtues: ['Ecosistema manglar √∫nico', 'Pesca artesanal tradicional', 'Biodiversidad excepcional', 'Cultura ind√≠gena viva'],
                img: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?auto=format&fit=crop&w=400&q=80'
            },
            {
                id: 4,
                name: 'Orillas del Lago de Maracaibo',
                type: 'playa',
                lat: 10.95,
                lon: -71.75,
                desc: 'Playas y pesquer√≠as tradicionales junto al Lago de Maracaibo, paisaje y cultura ribere√±a.',
                context: 'Las orillas del majestuoso Lago de Maracaibo son el alma econ√≥mica y cultural del Municipio Mara. Aqu√≠ se desarrolla la pescader√≠a ancestral que ha alimentado generaciones de marenses. Las viviendas palaf√≠ticas de origen ind√≠gena se alzan sobre las aguas como testimonio de la adaptaci√≥n humana a este entorno √∫nico. El lago no es solo una fuente de subsistencia, sino un s√≠mbolo de la identidad zuliana y la riqueza natural que Dios ha brindado a esta tierra noble.',
                virtues: ['Pesca tradicional ancestral', 'Viviendas palaf√≠ticas √∫nicas', 'Vista espectacular del lago', 'Cultura ribere√±a aut√©ntica'],
                img: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?auto=format&fit=crop&w=400&q=80'
            },
            {
                id: 5,
                name: 'Serran√≠as y Senderos',
                type: 'montana',
                lat: 10.9,
                lon: -71.8,
                desc: 'Sistemas monta√±osos y miradores con vistas panor√°micas del municipio.',
                context: 'Las serran√≠as del Municipio Mara son testigos silenciosos de la historia y la belleza natural de esta tierra. Desde estas alturas se puede contemplar la inmensidad del Lago de Maracaibo y las planicies que caracterizan la regi√≥n. Estos senderos naturales invitan a la contemplaci√≥n y al reencuentro con la naturaleza. Son lugares donde el esp√≠ritu se eleva junto con el paisaje, ofreciendo momentos de paz y conexi√≥n con la esencia misma de Mara.',
                virtues: ['Vistas panor√°micas espectaculares', 'Senderos naturales preservados', 'Paz y tranquilidad', 'Conexi√≥n con la naturaleza'],
                img: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=400&q=80'
            }
        ];

        // Variables globales
        let map = null;
        let markers = {};
        let isDarkMode = true;


        // Funci√≥n para inicializar el mapa (ya no se usa en la pantalla principal)
        function initMap() {
            // Esta funci√≥n ya no es necesaria para la pantalla principal
            // Los mapas se crean din√°micamente en los modales
            console.log('Mapa principal removido - se crean mapas din√°micos en modales');
            return true;
        }

        // Funci√≥n para renderizar destinos
        function renderDestinations(list) {
            const container = document.getElementById('destinations');
            
            if (!list || list.length === 0) {
                container.innerHTML = '<div class="empty-state">No se encontraron destinos</div>';
                return;
            }

            container.innerHTML = '';
            
            list.forEach(dest => {
                // Validar datos del destino
                if (!dest.id || !dest.name || !dest.lat || !dest.lon) {
                    console.warn('Destino con datos incompletos:', dest);
                    return;
                }

                const destEl = document.createElement('div');
                destEl.className = 'dest';
                destEl.draggable = true;
                destEl.dataset.id = dest.id;
                destEl.setAttribute('role', 'listitem');
                destEl.setAttribute('aria-label', `Destino: ${dest.name}`);

                destEl.innerHTML = `
                    <div style="position: relative;">
                        <img src="${dest.img}" alt="${dest.name}" 
                             style="cursor: pointer;"
                             onclick="showDestinationContext(${dest.id})"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjMzMzIi8+CjxwYXRoIGQ9Ik0zMiAyMEMzNi40MTgzIDIwIDQwIDE2LjQxODMgNDAgMTJDNDAgNy41ODE3MiAzNi40MTgzIDQgMzIgNEMyNy41ODE3IDQgMjQgNy41ODE3MiAyNCAxMkMyNCAxNi40MTgzIDI3LjU4MTcgMjAgMzIgMjBaIiBmaWxsPSIjNjY2Ii8+CjxwYXRoIGQ9Ik0zMiAzNkMzNi40MTgzIDM2IDQwIDMyLjQxODMgNDAgMjhDNDAgMjMuNTgxNyAzNi40MTgzIDIwIDMyIDIwQzI3LjU4MTcgMjAgMjQgMjMuNTgxNyAyNCAyOEMyNCAzMi40MTgzIDI3LjU4MTcgMzYgMzIgMzZaIiBmaWxsPSIjOTk5Ii8+CjxwYXRoIGQ9Ik0zMiA1MkMzNi40MTgzIDUyIDQwIDQ4LjQxODMgNDAgNDRDNDAgMzkuNTgxNyAzNi40MTgzIDM2IDMyIDM2QzI3LjU4MTcgMzYgMjQgMzkuNTgxNyAyNCA0NEMyNCA0OC40MTgzIDI3LjU4MTcgNTIgMzIgNTJaIiBmaWxsPSIjY2NjIi8+Cjwvc3ZnPgo='"/>
                        <div style="position: absolute; top: 2px; right: 2px; background: var(--accent1); color: #041017; 
                                    border-radius: 50%; width: 16px; height: 16px; display: flex; align-items: center; 
                                    justify-content: center; font-size: 10px; font-weight: bold;">üìñ</div>
                    </div>
                    <div class="meta">
                        <h4 style="cursor: pointer;" onclick="showDestinationContext(${dest.id})" title="Haz clic para ver m√°s informaci√≥n">${dest.name}</h4>
                        <p>${dest.desc}</p>
                        <div style="margin-top:8px">
                            <button class="go-btn" data-id="${dest.id}" 
                                    aria-label="Ir a ${dest.name}"
                                    onclick="goToDestination(${dest.id})">
                                üó∫Ô∏è Ir al Lugar
                            </button>
                        </div>
                    </div>
                `;

                // Eventos de arrastre
                destEl.addEventListener('dragstart', (e) => {
                    try {
                        e.dataTransfer.setData('text/plain', dest.id.toString());
                        e.dataTransfer.effectAllowed = 'copy';
                        destEl.classList.add('grab');
                    } catch (error) {
                        console.error('Error en dragstart:', error);
                    }
                });

                destEl.addEventListener('dragend', () => {
                    destEl.classList.remove('grab');
                });

                container.appendChild(destEl);

                // Preview al hacer hover (sin mapa)
                destEl.addEventListener('mouseover', () => {
                    try {
                        document.getElementById('preview').innerHTML = 
                            `<strong>${dest.name}</strong><div style="font-size:13px;color:var(--muted)">${dest.desc}</div>`;
                    } catch (error) {
                        console.error('Error en mouseover:', error);
                    }
                });

                destEl.addEventListener('mouseout', () => {
                    try {
                        document.getElementById('preview').innerHTML = 'Vista previa del destino';
                    } catch (error) {
                        console.error('Error en mouseout:', error);
                    }
                });
            });
        }


        // Funci√≥n para mostrar contexto de destino con mapa
        function showDestinationContext(destId) {
            const dest = destinations.find(d => d.id === destId);
            if (!dest) return;

            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex; 
                align-items: center; justify-content: center; padding: 10px;
                overflow-y: auto;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="background: var(--card); border-radius: 15px; padding: 20px; 
                           max-width: 900px; width: 100%; max-height: 95vh; overflow-y: auto; 
                           border: 1px solid var(--glass-2); position: relative;
                           margin: 10px;">
                    <button class="modal-close" onclick="this.parentElement.parentElement.remove()" 
                            style="position: absolute; top: 10px; right: 10px; 
                                   background: var(--accent1); color: #041017; border: none; 
                                   border-radius: 50%; width: 35px; height: 35px; cursor: pointer; 
                                   font-size: 18px; z-index: 10001;">√ó</button>
                    
                    <h2 style="color: var(--accent1); margin-top: 0; margin-right: 40px; font-size: 20px;">${dest.name}</h2>
                    
                    <div class="modal-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <!-- Informaci√≥n del destino -->
                        <div>
                            <div style="margin-bottom: 20px;">
                                <img src="${dest.img}" alt="${dest.name}" 
                                     style="width: 100%; height: 200px; object-fit: cover; border-radius: 10px;"
                                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM2NjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZW4gbm8gZGlzcG9uaWJsZTwvdGV4dD4KPC9zdmc+Cg=='"/>
                            </div>
                            
                            <h3 style="color: var(--accent2);">üìñ Contexto Hist√≥rico y Cultural</h3>
                            <p style="line-height: 1.6; margin-bottom: 20px;">${dest.context}</p>
                            
                            <h3 style="color: var(--accent2);">‚ú® Virtudes y Atractivos</h3>
                            <div style="display: grid; gap: 8px; margin-bottom: 20px;">
                                ${dest.virtues.map(virtue => `
                                    <div style="background: rgba(255,255,255,0.05); padding: 8px; border-radius: 6px; 
                                                border-left: 3px solid var(--accent1); font-size: 13px;">
                                        <span style="color: var(--accent2);">‚úì</span> ${virtue}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- Mapa del destino -->
                        <div>
                            <h3 style="color: var(--accent2); margin-top: 0;">üó∫Ô∏è Ubicaci√≥n</h3>
                            <div id="modal-map-${destId}" class="modal-map" style="width: 100%; height: 300px; border-radius: 10px; border: 1px solid var(--glass-2);"></div>
                            <div style="margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                                <p style="margin: 0; font-size: 12px; color: var(--muted);">
                                    <strong>Coordenadas:</strong> ${dest.lat.toFixed(6)}, ${dest.lon.toFixed(6)}<br>
                                    <strong>Tipo:</strong> ${dest.type.charAt(0).toUpperCase() + dest.type.slice(1)}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--glass-2);">
                        <button onclick="goToDestination(${dest.id})" 
                                style="background: linear-gradient(90deg, #10b981, #059669); 
                                       color: white; border: none; padding: 12px 24px; 
                                       border-radius: 25px; cursor: pointer; font-weight: bold; margin-right: 10px;">
                            üó∫Ô∏è Ir al Lugar
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="background: var(--glass); color: inherit; border: 1px solid rgba(255,255,255,0.1); 
                                       padding: 12px 24px; border-radius: 25px; cursor: pointer;">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Inicializar mapa en el modal
            setTimeout(() => {
                try {
                    if (typeof L !== 'undefined') {
                        const modalMap = L.map(`modal-map-${destId}`, { 
                            zoomControl: true,
                            attributionControl: true
                        }).setView([dest.lat, dest.lon], 13);
                        
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '¬© OpenStreetMap contributors',
                            maxZoom: 18
                        }).addTo(modalMap);
                        
                        L.marker([dest.lat, dest.lon])
                            .addTo(modalMap)
                            .bindPopup(`<strong>${dest.name}</strong><br>${dest.desc}`)
                            .openPopup();
                    }
                } catch (error) {
                    console.error('Error creando mapa en modal:', error);
                    document.getElementById(`modal-map-${destId}`).innerHTML = 
                        '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:var(--muted)">Error cargando mapa</div>';
                }
            }, 100);
        }

        // Funci√≥n para ir al destino en Google Maps
        function goToDestination(destId) {
            try {
                const dest = destinations.find(d => d.id === destId);
                if (!dest) {
                    console.error('Destino no encontrado:', destId);
                    return;
                }

                // Construir URL de Google Maps con direcciones
                const mapsUrl = `https://www.google.com/maps/dir/?api=1&destination=${dest.lat},${dest.lon}&travelmode=driving`;
                
                // Abrir en nueva pesta√±a
                window.open(mapsUrl, '_blank');
                
                console.log(`Navegando a ${dest.name} en Google Maps`);
                
            } catch (error) {
                console.error('Error abriendo Google Maps:', error);
                alert('Error al abrir Google Maps. Por favor, int√©ntalo de nuevo.');
            }
        }

        // Event listeners
        function setupEventListeners() {
            // Filtros
            document.getElementById('filters').addEventListener('click', (e) => {
                try {
                    const chip = e.target.closest('.chip');
                    if (!chip) return;

                    // Actualizar chip activo
                    document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');

                    const type = chip.dataset.type;
                    const query = document.getElementById('search').value.toLowerCase();
                    const filtered = destinations.filter(dest => 
                        (type === 'todo' || dest.type === type) && 
                        (dest.name.toLowerCase().includes(query) || dest.desc.toLowerCase().includes(query))
                    );
                    renderDestinations(filtered);
                } catch (error) {
                    console.error('Error en filtros:', error);
                }
            });

            // B√∫squeda
            document.getElementById('search').addEventListener('input', () => {
                try {
                    document.getElementById('filters').querySelector('.chip[data-type="todo"]').click();
                } catch (error) {
                    console.error('Error en b√∫squeda:', error);
                }
            });

            // Bot√≥n sugerir
            document.getElementById('btn-random').addEventListener('click', () => {
                try {
                    const pick = destinations[Math.floor(Math.random() * destinations.length)];
                    alert(`Sugerencia: ${pick.name}\n\n${pick.desc}`);
                } catch (error) {
                    console.error('Error en sugerencia aleatoria:', error);
                    alert('No se pudo generar una sugerencia en este momento.');
                }
            });

            // A√±adir destino por bot√≥n
            document.getElementById('destinations').addEventListener('click', (e) => {
                try {
                    const btn = e.target.closest('button');
                    if (!btn) return;

                    const id = Number(btn.dataset.id);
                    const dest = destinations.find(d => d.id === id);

                    if (dest && !itinerary.find(i => i.id === id)) {
                        itinerary.push(dest);

                        // Feedback visual
                        btn.textContent = '‚úì A√±adido';
                        btn.style.background = 'var(--accent2)';
                        setTimeout(() => {
                            btn.textContent = 'A√±adir';
                            btn.style.background = '';
                        }, 1000);
                    } else if (itinerary.find(i => i.id === id)) {
                        alert('Este destino ya est√° en tu itinerario');
                    }
                } catch (error) {
                    console.error('Error a√±adiendo destino:', error);
                }
            });

            // Drag & drop al itinerario
            document.getElementById('itinerary').addEventListener('dragover', (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'copy';
            });

            document.getElementById('itinerary').addEventListener('drop', (e) => {
                try {
                    e.preventDefault();
                    const idText = e.dataTransfer.getData('text/plain');
                    if (!idText) return;

                    const id = Number(idText);
                    const dest = destinations.find(d => d.id === id);

                    if (dest && !itinerary.find(i => i.id === id)) {
                        itinerary.push(dest);
                        if (markers[id]) {
                            markers[id].openPopup();
                        }
                    } else if (itinerary.find(i => i.id === id)) {
                        alert('Este destino ya est√° en tu itinerario');
                    }
                } catch (error) {
                    console.error('Error en drop:', error);
                }
            });

            // Reordenar en el itinerario
            const itListEl = document.getElementById('it-list');
            itListEl.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            });

            itListEl.addEventListener('drop', (e) => {
                try {
                    e.preventDefault();
                    const from = e.dataTransfer.getData('text/it');
                    if (!from) return;

                    const toNode = e.target.closest('.it-item');
                    const to = toNode ? Number(toNode.dataset.idx) : itinerary.length - 1;
                    const fromIdx = Number(from);

                    if (fromIdx !== to) {
                        const item = itinerary.splice(fromIdx, 1)[0];
                        itinerary.splice(to, 0, item);
                    }
                } catch (error) {
                    console.error('Error reordenando itinerario:', error);
                }
            });

            // Remover del itinerario
            itListEl.addEventListener('click', (e) => {
                try {
                    const btn = e.target.closest('button');
                    if (!btn) return;

                    if (btn.dataset.action === 'remove') {
                        const id = Number(btn.dataset.id);
                        itinerary = itinerary.filter(i => i.id !== id);
                    }
                } catch (error) {
                    console.error('Error removiendo del itinerario:', error);
                }
            });

            // Descargar itinerario
            document.getElementById('btn-download').addEventListener('click', () => {
                try {
                    if (itinerary.length === 0) {
                        alert('Tu itinerario est√° vac√≠o. A√±ade algunos destinos primero.');
                        return;
                    }

                    const data = {
                        created: new Date().toISOString(),
                        items: itinerary,
                        totalDestinations: itinerary.length,
                        exportInfo: 'Itinerario generado desde Turismo Municipio Mara'
                    };

                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `itinerario-mara-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);

                    // Feedback visual
                    const btn = document.getElementById('btn-download');
                    const originalText = btn.textContent;
                    btn.textContent = '‚úì Descargado';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                } catch (error) {
                    console.error('Error descargando itinerario:', error);
                    alert('No se pudo descargar el itinerario. Int√©ntalo de nuevo.');
                }
            });

            // Mostrar historia de Mara
            document.getElementById('btn-history').addEventListener('click', () => {
                try {
                    document.getElementById('history-modal').style.display = 'block';
                } catch (error) {
                    console.error('Error mostrando historia:', error);
                }
            });

            // Cerrar modal de historia
            document.getElementById('close-history').addEventListener('click', () => {
                try {
                    document.getElementById('history-modal').style.display = 'none';
                } catch (error) {
                    console.error('Error cerrando historia:', error);
                }
            });

            // Cerrar modal al hacer clic fuera
            document.getElementById('history-modal').addEventListener('click', (e) => {
                if (e.target.id === 'history-modal') {
                    document.getElementById('history-modal').style.display = 'none';
                }
            });

            // Cambiar tema
            document.getElementById('btn-theme').addEventListener('click', () => {
                try {
                    isDarkMode = !isDarkMode;
                    const btn = document.getElementById('btn-theme');
                    
                    if (isDarkMode) {
                        document.documentElement.style.setProperty('--bg', '#0f1724');
                        document.documentElement.style.setProperty('--card', '#0b1220');
                        document.documentElement.style.setProperty('--muted', 'rgba(255,255,255,0.6)');
                        btn.textContent = 'Modo Claro';
                    } else {
                        document.documentElement.style.setProperty('--bg', '#f7fafc');
                        document.documentElement.style.setProperty('--card', '#ffffff');
                        document.documentElement.style.setProperty('--muted', 'rgba(0,0,0,0.6)');
                        btn.textContent = 'Modo Oscuro';
                    }
                } catch (error) {
                    console.error('Error cambiando tema:', error);
                }
            });

            // Atajos de teclado
            document.addEventListener('keydown', (e) => {
                try {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        const first = destinations[0];
                        if (first && !itinerary.find(i => i.id === first.id)) {
                            itinerary.push(first);
                            alert(`A√±adido "${first.name}" al itinerario`);
                        }
                    }
                    if (e.key === 'Escape') {
                        document.getElementById('search').value = '';
                        document.getElementById('filters').querySelector('.chip[data-type="todo"]').click();
                    }
                } catch (error) {
                    console.error('Error en atajo de teclado:', error);
                }
            });
        }

        // Inicializaci√≥n principal
        function initializeApp() {
            try {
                console.log('Inicializando aplicaci√≥n de turismo...');

                // Renderizar destinos
                renderDestinations(destinations);
                
                // Configurar event listeners
                setupEventListeners();

                // Ocultar indicador de carga
                const loadingEl = document.getElementById('loading');
                if (loadingEl) {
                    loadingEl.style.display = 'none';
                }

                console.log('Aplicaci√≥n inicializada correctamente');

            } catch (error) {
                console.error('Error inicializando aplicaci√≥n:', error);
                
                // Mostrar error en pantalla
                const loadingEl = document.getElementById('loading');
                if (loadingEl) {
                    loadingEl.innerHTML = `
                        <div style="text-align:center;color:#ff6b6b">
                            <h3>Error cargando la aplicaci√≥n</h3>
                            <p>Por favor, recarga la p√°gina</p>
                            <button onclick="location.reload()" style="margin-top:10px;padding:10px 20px;background:#ff6b6b;color:white;border:none;border-radius:5px;cursor:pointer">
                                Recargar P√°gina
                            </button>
                        </div>
                    `;
                }
            }
        }

        // Inicializar cuando la p√°gina est√© lista
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>
</body>
</html>